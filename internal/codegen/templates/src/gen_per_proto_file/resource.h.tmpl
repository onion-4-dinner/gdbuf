// THIS FILE IS GENERATED BY GDBUF. DO NOT EDIT
{{- $protoPathNoExtension := trimSuffix ".proto" .ProtoPath }}
{{- $protoFileNameNoExtension := base $protoPathNoExtension }}
#pragma once

#include <string>
#include "godot_cpp/classes/resource.hpp"
#include "godot_cpp/classes/ref.hpp"
#include "godot_cpp/classes/wrapped.hpp"
#include "{{ $protoFileNameNoExtension }}.pb.h"
#include <cstdint> // Required for int64_t
#include <godot_cpp/variant/string.hpp>
#include <godot_cpp/variant/dictionary.hpp>
#include <godot_cpp/variant/array.hpp>
#include <godot_cpp/variant/variant.hpp>

{{- range .Dependencies }}
#include "{{ . }}"
{{- end }}

{{- range .ForwardDecls }}
namespace {{ .Namespace }} {
    class {{ .ClassName }};
}
{{- end }}

namespace gdbuf {
namespace {{ snakecase $protoFileNameNoExtension }} {
{{- range .Messages }}
class {{ .ClassName }};
{{- end }}

{{- range .Messages }}
{{- $className := .ClassName }}

class {{ $className }} : public godot::Resource {
  GDCLASS({{ $className }}, godot::Resource)

  public:
    {{- range .Oneofs }}
    enum {{ toPascalCase .Name }}Case {
        {{ toUpper (snakecase .Name) }}_NOT_SET = 0,
        {{- range .Fields }}
        k{{ toPascalCase .FieldName }} = {{ .Number }},
        {{- end }}
    };
    {{- end }}

  protected:
    static void _bind_methods();

  private:
    {{- range .Oneofs }}
    {{ toPascalCase .Name }}Case {{ snakecase .Name }}_case = {{ toUpper (snakecase .Name) }}_NOT_SET;
    {{- end }}

    {{- range .Fields }}
      {{- if .IsCustomType }}
    godot::Ref<{{ .GodotType }}> {{ snakecase .FieldName }};
      {{- else }}
    {{ .GodotType }} {{ snakecase .FieldName }}{};
      {{- end }}
    {{- end }}

  public:
    {{ $className }}() = default;
    ~{{ $className }}() override = default;
    godot::String get_proto_file_name();

    godot::PackedByteArray to_byte_array() const;
    godot::Error from_byte_array(const godot::PackedByteArray &p_bytes);
    godot::String _to_string() const;

    {{- range .Oneofs }}
    {{ toPascalCase .Name }}Case get_{{ snakecase .Name }}_case() const;
    {{- end }}

    {{- range .Fields }}
      {{- if .IsCustomType }}
    godot::Ref<{{ .GodotType }}> get_{{ .FieldName }}();
    void set_{{ snakecase .FieldName }}(const godot::Ref<{{ .GodotType }}> p_{{ snakecase .FieldName }});
      {{- else }}
    {{ .GodotType }} get_{{ .FieldName }}();
    void set_{{ snakecase .FieldName }}({{ .GodotType }} p_{{ snakecase .FieldName }});
      {{- end }}
    {{- end }}
};
{{- end }}
}
}

{{- range .Messages }}
{{- $className := .ClassName }}
{{- range .Oneofs }}
VARIANT_ENUM_CAST(gdbuf::{{ snakecase $protoFileNameNoExtension }}::{{ $className }}::{{ toPascalCase .Name }}Case);
{{- end }}
{{- end }}